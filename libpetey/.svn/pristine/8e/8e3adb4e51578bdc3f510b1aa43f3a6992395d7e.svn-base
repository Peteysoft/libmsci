#ifndef SC_TYPE__H 
#define SC_TYPE__H

#include "sparse_array.h"

using namespace libpetey;
using namespace libsparse;

typedef double scalar_t;
typedef int32_t integer;

typedef sparse<integer, scalar_t> sparse_t;
typedef full_matrix<integer, scalar_t> full_t;
typedef sparse_array<integer, scalar_t> sparse_array_t; 

class sc_t {
  public:
    virtual ~sc_t()=0;
    int tflag;

    virtual sc_t * mult(sc_t *cand)=0;
    virtual sc_t * add(sc_t *b)=0;
    virtual void neg()=0;
    virtual sc_t * operator [] (sc_t *sub)=0;
    virtual sc_t * norm();

    virtual int write(FILE *fs)=0;
    virtual int print(FILE *fs)=0;
    virtual int read(FILE *fs)=0;
};

class sc_str_t: public sc_t {
  public:
    sc_str_t(char *str);
    virtual ~sc_str_t();
    char *s;

};

template <class scalar_t>
class sc_scal_t: public sc_t {
  public:
    sc_scal_t(scalar_t val);
    virtual ~sc_scal_t();
    scalar_t value;

    virtual sc_t * mult(sc_t *cand);
    virtual sc_t * add(sc_t *b);
    virtual sc_t * neg();
    virtual sc_t * operator [] (sc_t *sub);
    virtual sc_t * norm();

    virtual int write(FILE *fs);
    virtual int print(FILE *fs);
    virtual int read(FILE *fs);
};

template <class scalar_t>
class sc_vec_t: public sc_t {
  public:
    scalar_t *data;
    integer_t n;
    sc_vec_t(scalar_t start, scalar_t finish);
    sc_vec_t(integer_t n);
    sc_vec_t(char *filename);
    virtual ~sc_vec_t();

    virtual sc_t * mult(sc_t *cand);
    virtual sc_t * add(sc_t *b);
    virtual sc_t * neg();
    virtual sc_t * operator [] (sc_t *sub);
    virtual sc_t * norm();

    virtual int write(FILE *fs);
    virtual int print(FILE *fs);
    virtual int read(FILE *fs);
};

template <class scalar_t>
class sc_mat_t: public sc_t {
  public:
    matrix_base<sc_int_t, scalar_t> *mat;

    sc_mat_t(char *fname);

    virtual sc_t * mult(sc_t *cand);
    virtual sc_t * add(sc_t *b);
    virtual sc_t * neg()=0;
    virtual sc_t * operator [] (sc_t *sub);
    virtual sc_t * norm();

    virtual int write(FILE *fs);
    virtual int print(FILE *fs);
    virtual int read(FILE *fs);
};


template <class scalar_t>
class sc_list_t: public sc_t {
  public:
    vector_e<sc_t *> list;

    virtual sc_t * mult(sc_t *cand);
    virtual sc_t * add(sc_t *b);
    virtual sc_t * neg();
    virtual sc_t * operator [] (sc_t *sub);
    virtual sc_t * norm();

    virtual int write(FILE *fs);
    virtual int print(FILE *fs);
    virtual int read(FILE *fs);
};

//variable type as integer code:
int sc_type_of(sc_t *v);

#endif

