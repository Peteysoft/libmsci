
\section{Model properties}

\subsection{Mass conservation}

\label{mass_conservation_derivation}

Suppose that:
\begin{equation}
	\sum_i q_i = const.
	\label{constant_mass}
\end{equation}
This will be true for non-divergent flows on equal area grids.
Then:
\begin{eqnarray}
	\sum_i \sum_j r_{ij} q_j & = & \sum_j q_j \\
	\sum_j q_j \left ( \sum_i r_{ij} - 1 \right ) & = & 0
\end{eqnarray}
Therefore:
\begin{equation}
	\sum_i r_{ij} = 1
\end{equation}
If (\ref{constant_mass}) is true, then:
\begin{equation}
	\frac{\mathrm d}{\mathrm d t}\sum_i q_i = 0
\end{equation}
is also be true. Continuing:
\begin{eqnarray}
	\sum_i \frac{\mathrm d q_i}{\mathrm d t} & = & 0 \\
\sum_i \sum_j a_{ij} q_j & = & 0 \\
\sum_j q_j \sum_i a_{ij} & = & 0
\end{eqnarray}
which shows the second part of (\ref{columns_sum_to_one}) and 
(\ref{columns_sum_to_zero}):
\begin{equation}
	\sum_i a_{ij} = 0
\end{equation}

\subsection{Diffusion and the Lyapunov spectrum}

\label{Lyapunov_exponents_less_than_zero}

A discrete tracer mapping will always require some 
amount of diffusion.  This means that the tracer configuration will 
tend towards a uniform distribution over time, 
that is, it will ``flatten out.''  We can
show that, given the constraint in (\ref{constant_mass}), 
a tracer field with all the same values has the smallest magnitude.  
Suppose there are only two elements in the 
tracer vector, $\vect q=\lbrace q,~q \rbrace$.  The magnitude of the vector is:
\begin{equation}
|\vect q|=\sqrt{q^2+q^2}=\sqrt{2} q
\end{equation}
Now we introduce a separation between the elements, $2\Delta q$, that 
nonetheless keeps the sum of the elements constant:
\begin{eqnarray}
|q+\Delta q,~q-\Delta q| & = & \sqrt{(q+\Delta q)^2+(q-\Delta q)^2} \\
& = & \sqrt{2}\sqrt{q^2+(\Delta q)^2} \ge \sqrt{2} q
\end{eqnarray}
This will generalize to higher-dimensional vectors.  In general, we can
say that:
\begin{equation}
\vect q R^T R \vect q \le | \vect q |^2
\label{tracer_map_inequality}
\end{equation}
Implying that for the eigenvalue problem,
\begin{eqnarray}
R^T R \vect v & = & s^2 \vect v \nonumber\\
s^2 & \le & 1 \label{SV_inequality}
\end{eqnarray}
Therefore the Lyapunov exponents are all
either zero or negative.
%with the largest equal to 0.  [why?]
Note however that this does not constitute a proof; the actual proof is more 
involved.

To prove (\ref{SV_inequality}) from (\ref{tracer_map_inequality}), we first
expand $\vect q$ in terms of the right singular values, 
$\lbrace \vect v_i \rbrace$:
\begin{equation}
	\vect q = \sum_i c_i \vect v_i
\end{equation}
where $\lbrace c_i \rbrace$ are a set of coefficients.
Substituting this into the left-hand-side of (\ref{tracer_map_inequality}):
\begin{eqnarray}
	\vect q R^T R \vect q & = & \sum_i c_i \vect v_i \sum_i c_i s_i^2 \vect v_i \\
   & = & \sum_i \sum_j c_i c_j s_i^2 \vect v_i \vect v_j \\
   & = & \sum_i \sum_j c_i c_j s_i^2 \delta_{ij} \\
	  & = & \sum_i c_i^2 s_i^2
\end{eqnarray}
where $\delta$ is the Kronecker delta.
Similarly, we can show that:
\begin{equation}
	\vect q \cdot \vect q = \sum_i c_i^2
\end{equation}
If we assume that $s_i \le 1$ for every $i$, then:
\begin{equation}
	\sum_i c_i^2 s_i^2 \le \sum_i c_i^2 
	\label{diffusive_inequality_in_terms_of_SVs}
\end{equation}
since each term on the left side is less-than-or-equal-to the
corresponding term on the right side. 
Note that in order for the inequality in 
(\ref{diffusive_inequality_in_terms_of_SVs}) to be broken, at least one
singular value must be greater-than one.
Therefore (\ref{tracer_map_inequality}) is true for every $\vect q$
if-and-only-if (\ref{SV_inequality}) is true for every $s$.
In the language of set theory and first-order logic:
\begin{equation}
	\forall \vect q \in \Re^n ~ (| R \vect q |^2 \le |\vect q |^2) \iff \forall s \in \Re | ~R^T R \vect v = s^2 \vect v ~ (s \le 1)
	\label{theorem}
\end{equation}

\section{Departure from equal area}

\label{equal_area}

Here we calculate the ratio between the largest and smallest grid boxes in the
azimuthal equidistant coordinate system.
First we show that there is no distortion at the pole:
\begin{eqnarray}
	\lim_{x\rightarrow 0, ~y\rightarrow 0} \left (\frac{\mathrm ds}{\mathrm d x} \right )^2 & = & 
	\lim_{x\rightarrow 0, ~y\rightarrow 0} \left (\frac{\mathrm ds}{\mathrm d y} \right )^2  \\
	& = & \lim_{x\rightarrow 0, ~y\rightarrow 0} \frac{1}{r^2} \left [
	\frac{R_E^2}{r^2} \sin^2 \left (\frac{r}{R_E} \right ) y^2 + x^2 \right ] \\
 & = & \frac{1}{r^2} \left [\frac{R_E^2}{r^2} \left (\frac{r}{R_E} \right )^2
	y^2 + x^2 \right ] \\ 
	& = & 1
\end{eqnarray}
hence the ratio between projected and unprojected areas is 1.
Grid areas become progressively smaller the further from the pole you get.
Since the projection is hemi-spherical, $r$ takes on a maximum value at the
equator:
\begin{equation}
	r=\pi R_E/2
\end{equation}
Hence the largest possible values for $x$ and $y$ are:
\begin{equation}
	x = y = \frac{\pi R_E}{2 \sqrt{2}}
\end{equation}
which represents a point on the equator along a diagonal from the origin 
in the projected coordinate system.
The metric coefficients can be calculated:
\begin{eqnarray}
	\left (\frac{\mathrm ds}{\mathrm d x} \right )^2 & = & 
	\left (\frac{\mathrm ds}{\mathrm d y} \right )^2 \\
     & = & \frac{4}{\pi^2 R_e^2} \left [
	\frac{4 R_E^2}{\pi^2 R_E^2} \sin^2 \left (\frac{\pi R_E}{2 R_E} \right ) 
\frac{\pi^2 R_E^2}{8} + \frac{\pi^2 R_E^2}{8} \right ] \\
& = & \frac{1}{\pi^2 R_E^2} \left ( 2 R_E^2 + \frac{\pi^2 R_E^2}{2} \right ) \\
& = & \frac{2}{\pi^2} + \frac{1}{2} \\
& \approx & 0.703
\end{eqnarray}
